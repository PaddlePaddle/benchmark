            os.environ["MASTER_ADDR"] = os.getenv("MASTER_ADDR", "localhost")
            os.environ["MASTER_PORT"] = os.getenv("MASTER_PORT", "12355")
            os.environ["RANK"] = os.getenv("RANK", "0")
            os.environ["WORLD_SIZE"] = os.getenv("WORLD_SIZE", "1")
            torch.cuda.set_device(int(os.environ["RANK"]))
            torch.distributed.init_process_group(
                "nccl"
            )
